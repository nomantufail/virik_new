<style>    .necessary-requirements select{        font-size: 12px;    }    .drivers-helpers select{        font-size: 12px;    }    table{        border: none;    }    .product_details_table{        width: 100%;    }    .product_details_table tr{        border-bottom: 2px solid gray;    }    .table>tbody>tr>th, .table>tbody>tr>td {        border-top: none;        border-bottom: none;    }</style><script>/*--------------- Pre loading Area ------------------*/var All_Freights = {};<?php foreach($freights as $group): ?>All_Freights["<?= $group[0]->source."_".$group[0]->destination."_".$group[0]->product ?>"] = <?= json_encode($group) ?>;<?php endforeach; ?>var Contractor_Customer_Commissions = {};<?php foreach($contractor_customer_commissions as $record): ?>Contractor_Customer_Commissions["<?= $record->key ?>"] = <?= json_encode($record) ?>;<?php endforeach; ?>var Contractor_Company_Commissions = {};<?php foreach($contractor_company_commissions as $record): ?>Contractor_Company_Commissions["<?= $record->key ?>"] = <?= json_encode($record) ?>;<?php endforeach; ?>/*---------------------------------------------------*/function check_form_validations(){    var fault_pannels = '';    var pannel_count = document.getElementById("pannel_count").value;    for(var count = 0; count <( pannel_count-1); count ++){        var company_freight_unit = document.getElementsByClassName('company_freight_unit_1')[count];        var freight_unit = document.getElementsByClassName('freight_unit_1')[count];        if(company_freight_unit.value != freight_unit.value){            fault_pannels = fault_pannels+''+(count+1)+', ';        }    }    if(fault_pannels != ''){        var msg = 'WARNING!\n'+'company freight/unit and customer freight/unit is not same in product details# '+fault_pannels+'';        if(confirm(msg) == false){            return false;        }    }    var start_meter = document.getElementById('start_meter_reading').value;    var end_meter = document.getElementById('end_meter_reading').value;    if((end_meter - start_meter) < 0){        alert("WARNING!\nend meter reading cannot be less than start meter reading.\nPlease correct.");        return false;    }    /*checking the security pin*/    var actual_pin = '<?= $pin ?>';    var given_pin = document.getElementById('security_pin').value;    if(actual_pin != given_pin)    {        alert("WARNING!\nInvalid Security Code.");        return false;    }    /********************************/    return true;}function fetch_tankers(customer_id, callback){    var tankers_area = document.getElementById("tankers_area");    tankers_area.innerHTML = "please wait...";    $.get("<?=base_url()."trips/fetch_tankers/"?>"+customer_id,function(data,status){        tankers_area.innerHTML= data;        callback();    });}function show_selected_tanker_info(tanker_id, callback){    var tanker_info = document.getElementById("tanker_info");    tanker_info.innerHTML = "loading...";    $.get("<?=base_url()."trips/fetch_tanker/"?>"+tanker_id,function(data,status){        tanker_info.innerHTML= data;        callback();    });}function fetch_customer_contractor_commission(customer_id, contractor_id, callback){    var key = contractor_id+'_'+customer_id;    var commission = {        'freight_commission':null    };    if(Contractor_Customer_Commissions[''+key] == undefined)    {        callback(commission);        return;    }    commission.freight_commission = Contractor_Customer_Commissions[''+key].freight_commission;    callback(commission);}function fetch_company_contractor_commission(company_id, contractor_id, callback){    var key = contractor_id+'_'+company_id;    var commission = {        'commission_1':null,        'wht' : null    };    if(Contractor_Company_Commissions[''+key] == undefined)    {        callback(commission);        return;    }    commission.commission_1 = Contractor_Company_Commissions[''+key].commission_1;    commission.wht = Contractor_Company_Commissions[''+key].commission_2;    callback(commission);}function fetch_freight(sourceCity, destinationCity, product, callback){    var date = document.getElementById('filling_date').value;    var key = sourceCity+"_"+destinationCity+"_"+product;    var freight = get_freight_by_key(key, date);    callback(freight);}function tanker_changed(dropdown){    var myindex  = dropdown.selectedIndex;    var tanker_id = dropdown.options[myindex].value;    show_selected_tanker_info(tanker_id,function(){        meter_reading_changed();    })}function take_care_of_product_info_and_commissions_data(callback){    var customer_selected_index = document.getElementById("customers").selectedIndex;    var customer_id = document.getElementById("customers").options[customer_selected_index].value;    var contractors_selected_index = document.getElementById("contractors").selectedIndex;    var contractor_id = document.getElementById("contractors").options[contractors_selected_index].value;    var companies_selected_index = document.getElementById("companies").selectedIndex;    var company_id = document.getElementById("companies").options[companies_selected_index].value;    //empty those feilds before you put new data into them    var contractor_commission_input = document.getElementById("contractor_commission_input");    var remaining_for_customer_area = document.getElementById("customer_freight");    var company_commission_1_input = document.getElementById("company_commission_1_input");    var wht_input = document.getElementById("company_commission_2_input");    contractor_commission_input.value = "";    remaining_for_customer_area.innerHTML = "";    company_commission_1_input.value = "";    wht_input.value = "";    //fetching cutomer_contractor_commission and setting it to its objectives...    fetch_customer_contractor_commission(customer_id, contractor_id, function(result) {        //setting contractor commission        contractor_commission_input.value = (result.freight_commission != null)?result.freight_commission: '';        //setting remaining for customer percentage        remaining_for_customer_area.innerHTML = (100 - contractor_commission_input.value);        //setting data related to product info panels        var pannel_count = document.getElementById("pannel_count");        for(var count = 0; count<(pannel_count.value-1); count++){            var initial_quantity_input = document.getElementsByClassName("initial_product_quantity_1")[count];            var freight_unit_input = document.getElementsByClassName("freight_unit_1")[count];            var total_freight_rs = document.getElementsByClassName("total_freight_rs_1")[count];            var price_unit_input = document.getElementsByClassName("price_unit_1")[count];            var contractor_commission_rs = document.getElementsByClassName("contractor_commission_rs_1")[count];            var remaining_for_customer_rs = document.getElementsByClassName("remaining_for_customer_rs_1")[count];            //setting contractor commission rupees in products info area..            contractor_commission_rs.innerHTML = contractor_commission_input.value * (((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input.value)/100;            //setting remaining for customer rupees in products info area..            remaining_for_customer_rs.innerHTML = ((((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input.value) - contractor_commission_rs.innerHTML);        }//for loop ends here..        //fetching_contractor_company_commission and setting it to its objectives...        fetch_company_contractor_commission(company_id, contractor_id, function(result) {            company_commission_1_input.value = result.commission_1;            wht_input.value = result.wht;            var pannel_count = document.getElementById("pannel_count");            for(var count = 0; count<(pannel_count.value-1); count++){                var initial_quantity_input = document.getElementsByClassName("initial_product_quantity_1")[count];                var freight_unit_input = document.getElementsByClassName("freight_unit_1")[count];                var company_commission_1_rs = document.getElementsByClassName("company_commission_1_rs_1")[count];                var company_wht_rs_1 = document.getElementsByClassName("wht_rs_1")[count];                //setting company commissions rupees in products info area..                company_commission_1_rs.innerHTML = company_commission_1_input.value * (((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input.value)/100;                company_wht_rs_1.innerHTML = wht_input.value * (((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input.value)/100;            }//for loop ends here...        })    });    callback();}function customer_changed(dropdown){    var myindex  = dropdown.selectedIndex;    var customer_id = dropdown.options[myindex].value;    /*     below we will fetch tankers and afer successfully rendring them we will fetch selected tanker info     and render it in tanker info pannel     */    take_care_of_product_info_and_commissions_data(function(){        fetch_tankers(customer_id, function() {            var tankers_selected_index = document.getElementById("tankers").selectedIndex;            var tanker_id = document.getElementById("tankers").options[tankers_selected_index].value;            show_selected_tanker_info(tanker_id, function() {            });        });    });    return true}function contractor_changed(){    take_care_of_product_info_and_commissions_data(function() {    });}function company_changed(){    take_care_of_product_info_and_commissions_data(function() {    });}function meter_reading_changed(){    var start = parseFloat(document.getElementById('start_meter_reading').value);    var end = parseFloat(document.getElementById('end_meter_reading').value);    var fuel = parseFloat(document.getElementById('fuel_consumed').value);    var distance = end - start;    var fuel_km = 0;    if(fuel > 0 && distance > 0){        fuel_km = limit_number(distance/fuel);    }    document.getElementById('fuel_per_km').innerHTML = fuel_km;    document.getElementById('net_meter').innerHTML = distance;}function i_think_route_changed(count,section){    //below we are checking weather this function should countinue or return...    var pannel_count = document.getElementById("pannel_count");    if(section === undefined){        if(count === undefined)            count = 0;        if(count >=(pannel_count.value-1)) return;    }else{        count = section-1;    }    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    //fetching selected sourceCity    var tankers_source_index = document.getElementsByClassName("sourceCity")[count].selectedIndex;    var source_id = document.getElementsByClassName("sourceCity")[count].options[tankers_source_index].value;    //fetching selected destination    var tankers_destination_index = document.getElementsByClassName("destinationCity")[count].selectedIndex;    var destination_id = document.getElementsByClassName("destinationCity")[count].options[tankers_destination_index].value;    //fetching selected product    var product_index = document.getElementsByClassName("product")[count].selectedIndex;    var product_id = document.getElementsByClassName("product")[count].options[product_index].value;    fetch_freight(source_id, destination_id, product_id, function(freight) {        var freight_unit = document.getElementsByClassName("freight_unit_1")[count];        var company_freight_unit = document.getElementsByClassName("company_freight_unit_1")[count];        freight_unit.value = freight.freight;        company_freight_unit.value = freight.freight;        //now setting every thing else...        i_think_quantity_changed();        //increment the counter and re-calling the function for muliple products effetct..        if(section === undefined){            count++;            i_think_route_changed(count);        }        //////////////////////////////////////////////////////////////////////////////////////    })}//function ends here...function i_think_quantity_changed(panel){    var pannel_count = document.getElementById("pannel_count");    for(var count = 0; count<(pannel_count.value-1); count++){        var initial_quantity_input_1 = document.getElementsByClassName("initial_product_quantity_1")[count];        var freight_unit_input = document.getElementsByClassName("freight_unit_1")[count];        var total_freight_rs = document.getElementsByClassName("total_freight_rs_1")[count];        var price_unit_input = document.getElementsByClassName("price_unit_1")[count];        var shortage_at_destination_input_1 = document.getElementsByClassName("shortage_at_destination_1")[count];        var shortage_after_decanding_input_1 = document.getElementsByClassName("shortage_after_decanding_1")[count];        var quantity_at_destination_1 = document.getElementsByClassName("quantity_at_destination_1")[count];        var quantity_after_decanding_1 = document.getElementsByClassName("quantity_after_decanding_1")[count];        var total_shortage = document.getElementsByClassName("total_shortage_1")[count];        var expense_at_destination_rs_1 = document.getElementsByClassName("expense_at_destination_rs_1")[count];        var expense_after_decanding_rs_1 = document.getElementsByClassName("expense_after_decanding_rs_1")[count];        var total_product_expense = document.getElementsByClassName("total_expense_rs_1")[count];        var contractor_commission_input = document.getElementById("contractor_commission_input");        var company_commission_1_input = document.getElementById("company_commission_1_input");        var wht_input = document.getElementById("company_commission_2_input");        total_freight_rs.innerHTML = limit_number(((initial_quantity_input_1.value != '')?initial_quantity_input_1.value:0) * ((freight_unit_input.value !='')?freight_unit_input.value:0));        quantity_at_destination_1.innerHTML = limit_number(((initial_quantity_input_1.value != '')?initial_quantity_input_1.value:0) - ((shortage_at_destination_input_1.value != 0)?shortage_at_destination_input_1.value:0));        quantity_after_decanding_1.innerHTML = limit_number(parseFloat(quantity_at_destination_1.innerHTML) - ((shortage_after_decanding_input_1.value != 0)?shortage_after_decanding_input_1.value:0));        total_shortage.innerHTML = limit_number(parseFloat(((shortage_after_decanding_input_1.value != 0)?shortage_after_decanding_input_1.value:0)) + parseFloat(((shortage_at_destination_input_1.value != 0)?shortage_at_destination_input_1.value:0)));        expense_at_destination_rs_1.innerHTML = limit_number(((price_unit_input.value != 0)?price_unit_input.value:0) * ((shortage_at_destination_input_1.value != 0)?shortage_at_destination_input_1.value:0));        expense_after_decanding_rs_1.innerHTML = limit_number(((price_unit_input.value != 0)?price_unit_input.value:0) * ((shortage_after_decanding_input_1.value != 0)?shortage_after_decanding_input_1.value:0));        total_product_expense.innerHTML = limit_number(parseFloat(expense_at_destination_rs_1.innerHTML) + parseFloat(expense_after_decanding_rs_1.innerHTML));        var company_commission_1_rs = document.getElementsByClassName("company_commission_1_rs_1")[count];        var company_wht_rs_1 = document.getElementsByClassName("wht_rs_1")[count];        //setting company commissions rupees in products info area..        company_commission_1_rs.innerHTML = limit_number(company_commission_1_input.value * (((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input_1.value)/100);        company_wht_rs_1.innerHTML = limit_number(wht_input.value * (((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input_1.value)/100);        var contractor_commission_rs = document.getElementsByClassName("contractor_commission_rs_1")[count];        var remaining_for_customer_rs = document.getElementsByClassName("remaining_for_customer_rs_1")[count];        //setting contractor commission rupees in products info area..        contractor_commission_rs.innerHTML = limit_number(contractor_commission_input.value * (((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input_1.value)/100);        //setting remaining for customer rupees in products info area..        remaining_for_customer_rs.innerHTML = limit_number((((freight_unit_input.value !='')?freight_unit_input.value:0) * initial_quantity_input_1.value) - contractor_commission_rs.innerHTML);        //setting customer percentage on changing commissions inputs...        var remaining_for_customer_percentage = document.getElementById("customer_freight");        remaining_for_customer_percentage.innerHTML = 100-contractor_commission_input.value;    }//for loop ends....}   //function ends here...function display_row(){    var pannel_count = document.getElementById("pannel_count");    var row_id = "row_"+pannel_count.value;    document.getElementById(row_id).style.display='table';    document.getElementById(row_id).style.width='100%';    pannel_count.value = parseInt(pannel_count.value)+1;    //we think that when a new row is added we should re_populate the form...    i_think_route_changed(0,pannel_count.value-1);}function hide_row(){    var pannel_count = document.getElementById("pannel_count");    var decrease_count = parseInt(pannel_count.value)-1;    var row_id = "row_"+decrease_count;    if(pannel_count.value > 2){        document.getElementById(row_id).style.display='none';        pannel_count.value = parseInt(pannel_count.value)-1;    }}//here is the stuff we do when document is ready...$( document ).ready(function() {    //fetching the freight/unit for the selected route in product info....    //i_think_route_changed();    i_think_quantity_changed();    meter_reading_changed();});$(document).ajaxComplete(function(){});</script><div id="page-wrapper" style="min-height: 700px;">    <div class="container-fluid">    <section class="col-md-12">        <div id="myTab" class="">            <?php echo validation_errors('<div class="alert alert-danger alert-dismissible" role="alert">                                            <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>                                            <strong>Error! </strong>', '</div>');            ?>            <?php if(is_array($someMessage)){ ?>                <div class="alert <?= $someMessage['type']; ?> alert-dismissible" role="alert">                    <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>                    <?= $someMessage['message']; ?>                </div>            <?php } ?>        </div>    </section>    <form class="form-horizontal" role="form" action="<?= base_url()."trips/edit/".$trip[0]->trip_id; ?>" method="post" onsubmit="return check_form_validations();">    <div class="row">        <div class="col-lg-12">            <section class="col-md-6">                <h2 class="page-header">                    Edit Trip #<?= $trip_id ?>                    <small>                        <?php include_once(APPPATH."views/trips/components/make_trip_parts/trip_types.php") ?>                    </small>                </h2>            </section>            <section class="col-md-3">                <ul id="myTab" class="nav nav-pills">                    <!--<li><a href="<?/*= base_url()."trips/details/".$trip_id;*/?>">Details</a></li>-->                    <!--<li class="active"><a href="<?/*= base_url()."trips/edit/".$trip_id;*/?>">Edit</a></li>                    <li class=""><a href="<?/*= base_url()."trips/make/";*/?>">Make</a></li>-->                </ul>            </section>        </div>    </div>    <div class="row">    <input type="hidden" value="<?= $trip[0]->trip_id ?>" name="trip_id">    <div class="col-md-8">        <div class="col-lg-12">            <div class="panel panel-default">                <div class="panel-heading">                    <h3 class="panel-title"><i class="fa fa-clock-o fa-fw"></i> Necessary Requirements</h3>                </div>                <div class="panel-body">                    <div class="list-group">                        <div class="form-group">                            <label class="col-md-3 control-label">Customer</label>                            <div class="col-md-9">                                <input type="hidden" value="<?= $trip[0]->customer_id ?>" name="previous_customer" >                                <select class="form-control customers_select" style="width:300px; font-size: 12px; font-size: 12px;" id="customers" name="customers" onchange="customer_changed(this.form.customers);">                                    <?php                                    foreach($customers as $customer){                                        $selected = ($customer->id == $trip[0]->customer_id)?"selected":"";                                        echo "<option value=$customer->id $selected >$customer->name</option>";                                    }                                    ?>                                </select>                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-3 control-label">Contract Agent</label>                            <div class="col-md-9" id="">                                <input type="hidden" value="<?= $trip[0]->contractor_id ?>" name="previous_contractor" >                                <select class="form-control contractors_select" style="width:300px; font-size: 12px;" onchange="contractor_changed()" name="contractors" id="contractors">                                    <?php                                    foreach($contractors as $contractor){                                        $selected = ($contractor->id == $trip[0]->contractor_id)?"selected":"";                                        echo "<option value=$contractor->id $selected>$contractor->name</option>";                                    }                                    ?>                                </select>                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-3 control-label">Company</label>                            <div class="col-md-9">                                <input type="hidden" value="<?= $trip[0]->company_id ?>" name="previous_company" >                                <select class="form-control companies_select" style="width:300px; font-size: 12px;" onchange="company_changed()" name="companies" id="companies">                                    <?php                                    foreach($companies as $company){                                        $selected = ($company->id == $trip[0]->company_id)?"selected":"";                                        echo "<option value=$company->id $selected>$company->name</option>";                                    }                                    ?>                                </select>                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-3 control-label">Oil Tanker</label>                            <div class="col-md-9">                                <div id="tankers_area">                                    <select class="form-control tankers_select" style="width:300px; font-size: 12px;" name="tankers" id="tankers" onchange="tanker_changed(this.form.tankers)">                                        <?php                                        foreach($tankers as $tanker){                                            $disable = "";                                            if($tanker->free == false && $tanker->id != $trip[0]->tanker_id)                                            {                                                $disable = "disabled";                                            }                                            $style = "";                                            if($tanker->free == false && $tanker->id != $trip[0]->tanker_id)                                            {                                                $style = ($tanker->free == true)?"":"style='color:red'";                                            }                                            //$style = ($tanker->free == true)?"":"style='color:red'";                                            if($tanker->free == true && $tanker->customerId == $selected_customer)                                            {                                                $style = "style='color:white; background-color:green ;border-bottom:1px solid white;'";                                            }                                            $value = "";                                            if(($tanker->free == true) || ($tanker->free == false && $tanker->id == $trip[0]->tanker_id))                                            {                                                $value = $tanker->id;                                            }                                            //$value = ($tanker->free == true)?$tanker->id:'';                                            $selected = ($tanker->id == $trip[0]->tanker_id)?"selected":"";                                            echo "<option $disable $style $selected value=$value>$tanker->truck_number</option>";                                        }                                        ?>                                    </select>                                </div>                            </div>                        </div>                                <span id="variable_stuff">                                <?php                                $company_commission_1 = $trip[0]->company_commission_1;                                $company_commission_2 = $trip[0]->company_commission_2;                                $contractor_commission = $trip[0]->contractor_commission;                                $remaining_for_customer = 100-$contractor_commission;                                ?>                                    <div class="form-group">                                        <label class="col-md-6 control-label">Carriage Contractor Commission</label>                                        <div class="col-md-6" style="margin-top: 8px;">                                            <input onkeyup="i_think_quantity_changed()" class="" onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any" size="1" value="<?= $contractor_commission ?>" name='contractor_commission' id='contractor_commission_input'>%                                        </div>                                    </div>                                    <div class="form-group">                                        <label class="col-md-6 control-label">Company Commission_1</label>                                        <div class="col-md-6" style="margin-top: 8px;">                                            <span id="contractor_commission_txt"><input required="required" onkeyup="i_think_quantity_changed()" size="3" class=""  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  value="<?= $company_commission_1 ?>" name='company_commission_1' id='company_commission_1_input'></span>%                                        </div>                                    </div>                                    <div class="form-group">                                        <label class="col-md-6 control-label">Withholding Tax</label>                                        <div class="col-md-6" style="margin-top: 8px;">                                            <span id="contractor_commission_txt"><input required="required" onkeyup="i_think_quantity_changed()" size="3" class=""  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  value="<?= $company_commission_2 ?>" name='company_commission_2' id='company_commission_2_input'></span>%                                        </div>                                    </div>                                    <div class="form-group">                                        <label class="col-md-6 control-label">Remaining (for customer)</label>                                        <div class="col-md-6" style="margin-top: 8px;">                                            <input class="" type="hidden" value="<?= $remaining_for_customer; ?>" name='remaining_for_customer' id='remaining_customer_input' "">                                            <span id="customer_freight"><?= $remaining_for_customer; ?></span>%                                        </div>                                    </div>                                </span>                    </div>                </div>            </div>        </div>        <div class="col-lg-12">            <div class="panel panel-default">                <div class="panel-heading">                    <h3 class="panel-title"><i class="fa fa-clock-o fa-fw"></i> Date And Time</h3>                </div>                <div class="panel-body">                    <div class="list-group">                        <div class="form-group">                            <label class="col-md-4 control-label">Entry-Date</label>                            <div class="col-md-8">                                <input class="form-control" value="<?= $trip[0]->entryDate; ?>" placeholder="" type="date" required="required" name='entry_date' id='entry_date' "">                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-4 control-label">Email-Date</label>                            <div class="col-md-8">                                <input class="form-control" value="<?= $trip[0]->email_date; ?>" placeholder="" type="date" name='email_date' id='email_date' "">                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-4 control-label">Filling-Date</label>                            <div class="col-md-8">                                <input class="form-control" value="<?= $trip[0]->filling_date; ?>" placeholder="" type="date" name='filling_date' id='filling_date' "">                            </div>                        </div>                    </div>                    <div class="text-right">                    </div>                </div>            </div>        </div>        <div id="products_details">            <div class="col-lg-12">                <div class="panel panel-default">                    <div class="panel-heading">                        <h3 class="panel-title"><i class="fa fa-clock-o fa-fw"></i> Add Products Info</h3>                    </div>                    <div class="panel-body">                    <input type="hidden" value="<?= sizeof($trip) ?>" name="num_saved_trips_details">                        <table style="width: 100%; font-size: 12px;" class="product_details_table">                            <?php                            for($row_counter = 1; $row_counter<=sizeof($trip); $row_counter++){                            ?>                                <tr id="row_<?= $row_counter ?>" style="display:table; width: 100%;">                                    <td>                                        <input type="hidden" value="<?= $trip[$row_counter-1]->trips_details_id; ?>" name="trips_details_id_<?= $row_counter ?>">                                        <table class="table" style="margin-top: 15px; width: 100%;">                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td style="width: ;"><b>Source</b><br>                                                    <select name="sourceCity_<?= $row_counter ?>" onchange="i_think_route_changed(0,<?= $row_counter ?>)" class="sourceCity source_city_select" style="width: 100%;">                                                        <?php                                                        foreach($cities as $city){                                                            $selected = ($trip[$row_counter-1]->source == $city->id)?"selected":"";                                                            ?>                                                            <option value="<?= $city->id; ?>" <?= $selected ?> ><?= $city->cityName; ?></option>                                                        <?php                                                        }                                                        ?>                                                    </select>                                                </td>                                                <td style="vertical-align: bottom; text-align: center;">                                                    <b>To</b>                                                </td>                                                <td>                                                    <b>Destination</b><br>                                                    <select name="destinationCity_<?= $row_counter ?>" onchange="i_think_route_changed(0,<?= $row_counter ?>)" class="destinationCity destination_city_select" style="width: 90%;">                                                        <?php                                                        foreach($cities as $city){                                                            $selected = ($trip[$row_counter-1]->destination == $city->id)?"selected":"";                                                            ?>                                                            <option value="<?= $city->id; ?>" <?= $selected ?> ><?= $city->cityName; ?></option>                                                        <?php                                                        }                                                        ?>                                                    </select>                                                </td>                                                <td>                                                    <b>Product</b><br>                                                    <select name="product_<?= $row_counter ?>" onchange="i_think_route_changed(0,<?= $row_counter ?>)" class="product product_select" style="width: 90%;">                                                        <?php                                                        foreach($products as $product){                                                            $selected = ($trip[$row_counter-1]->product == $product->id)?"selected":"";                                                            ?>                                                            <option value="<?= $product->id; ?>" <?= $selected ?> ><?= $product->productName; ?></option>                                                        <?php                                                        }                                                        ?>                                                    </select>                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Quantity</b><br>                                                    <input name="initial_product_quantity_<?= $row_counter ?>" value="<?= $trip[$row_counter-1]->product_quantity ?>" class="initial_product_quantity_1" onkeyup="i_think_quantity_changed()"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Price/Unit</b><br>                                                    <input disabled name="price_unit_<?= $row_counter ?>" value="<?= $trip[$row_counter-1]->price_unit ?>" class="price_unit_1" onkeyup="i_think_quantity_changed()"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Freight/Unit</b><br>                                                    <input name="company_freight_unit_<?= $row_counter ?>" class="company_freight_unit_1" value="<?= $trip[$row_counter-1]->company_freight_unit ?>" style="width: 80px;" type="number" step="any">                                                    <input name="freight_unit_<?= $row_counter ?>" value="<?= $trip[$row_counter-1]->freight_unit ?>" class="freight_unit_1" onkeyup="i_think_quantity_changed()"  onchange="i_think_quantity_changed()" style="width: 80px;" type="number" step="any"  size="10"> <br><br>                                                    <b>Total-Frt: </b><span class="total_freight_rs_1"></span>                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Shrt at DESTIN</b><br>                                                    <input disabled name="shortage_at_destination_<?= $row_counter ?>" value="<?= ($trip[$row_counter-1]->product_quantity - $trip[$row_counter-1]->qty_at_destination) ?>" onkeyup="i_think_quantity_changed()" class="shortage_at_destination_1"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Qty at DESTIN: </b><span class="quantity_at_destination_1"></span><br>                                                    <b>Exp at Destin: </b><span class="expense_at_destination_rs_1"></span> Rs.                                                </td>                                                <td>                                                    <b>Cont-Comsn: </b><span class="contractor_commission_rs_1"></span> Rs.                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Shrt after Decand: </b><br>                                                    <input disabled name="shortage_after_decanding_<?= $row_counter ?>" value="<?= ($trip[$row_counter-1]->qty_at_destination - $trip[$row_counter-1]->qty_after_decanding) ?>" onkeyup="i_think_quantity_changed()" class="shortage_after_decanding_1"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Qty after DECAND: </b><span class="quantity_after_decanding_1"></span><br>                                                    <b>Exp after Decand: </b><span class="expense_after_decanding_rs_1"></span> Rs.<br>                                                </td>                                                <td>                                                    <b>Comp-Comsn: </b><span class="company_commission_1_rs_1"></span> Rs.<br>                                                    <b>W.H.T: </b><span class="wht_rs_1"></span> Rs.                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Stn-Number</b><br>                                                    <input type="text" name="stn_number_<?= $row_counter ?>"  value="<?= $trip[$row_counter-1]->stn_number ?>" size="10" style="width: 100px;">                                                </td>                                                <td>                                                    <b>Total Shrt: </b><span class="total_shortage_1"></span><br>                                                    <b>Total Exp: </b><span class="total_expense_rs_1"></span> Rs.                                                </td>                                                <td>                                                    <b>Cstm-Frt: </b><span class="remaining_for_customer_rs_1"></span> Rs.                                                </td>                                            </tr>                                        </table>                                    </td>                                </tr>                            <?php                            }                            ?>                            <?php                            for($row_counter = sizeof($trip)+1; $row_counter<7; $row_counter++){                            ?>                                <tr id="row_<?= $row_counter ?>" style="display: none; width: 100%;">                                    <td>                                        <table class="table" style="margin-top: 15px; width: 100%;">                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td style="width: ;"><b>Source</b><br>                                                    <select name="sourceCity_<?= $row_counter ?>" onchange="i_think_route_changed(0,<?= $row_counter?>)" class="sourceCity source_city_select" style="width: 100%;">                                                        <?php                                                        foreach($cities as $city){                                                            ?>                                                            <option value="<?= $city->id; ?>"><?= $city->cityName; ?></option>                                                        <?php                                                        }                                                        ?>                                                    </select>                                                </td>                                                <td style="vertical-align: bottom; text-align: center;">                                                    <b>To</b>                                                </td>                                                <td>                                                    <b>Destination</b><br>                                                    <select name="destinationCity_<?= $row_counter ?>" onchange="i_think_route_changed(0,<?= $row_counter?>)" class="destinationCity destination_city_select" style="width: 90%;">                                                        <?php                                                        foreach($cities as $city){                                                            ?>                                                            <option value="<?= $city->id; ?>" ><?= $city->cityName; ?></option>                                                        <?php                                                        }                                                        ?>                                                    </select>                                                </td>                                                <td>                                                    <b>Product</b><br>                                                    <select name="product_<?= $row_counter ?>" onchange="i_think_route_changed(0,<?= $row_counter?>)" class="product product_select" style="width: 90%;">                                                        <?php                                                        foreach($products as $product){                                                            ?>                                                            <option value="<?= $product->id; ?>" ><?= $product->productName; ?></option>                                                        <?php                                                        }                                                        ?>                                                    </select>                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Quantity</b><br>                                                    <input name="initial_product_quantity_<?= $row_counter ?>" class="initial_product_quantity_1" onkeyup="i_think_quantity_changed()"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Price/Unit</b><br>                                                    <input name="price_unit_<?= $row_counter ?>" class="price_unit_1" onkeyup="i_think_quantity_changed()"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Freight/Unit</b><br>                                                    <input name="company_freight_unit_<?= $row_counter ?>" class="company_freight_unit_1" value="" style="width: 80px;" type="number" step="any">                                                    <input name="freight_unit_<?= $row_counter ?>" class="freight_unit_1" onkeyup="i_think_quantity_changed()"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10"> <br><br>                                                    <b>Total-Frt: </b><span class="total_freight_rs_1"></span>                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Shrt at DESTIN</b><br>                                                    <input name="shortage_at_destination_<?= $row_counter ?>" onkeyup="i_think_quantity_changed()" class="shortage_at_destination_1"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Qty at DESTIN: </b><span class="quantity_at_destination_1"></span><br>                                                    <b>Exp at Destin: </b><span class="expense_at_destination_rs_1"></span> Rs.                                                </td>                                                <td>                                                    <b>Cont-Comsn: </b><span class="contractor_commission_rs_1"></span> Rs.                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Shrt after Decand: </b><br>                                                    <input name="shortage_after_decanding_<?= $row_counter ?>" onkeyup="i_think_quantity_changed()" class="shortage_after_decanding_1"  onchange="i_think_quantity_changed()" style="width: 100px;" type="number" step="any"  size="10">                                                </td>                                                <td>                                                    <b>Qty after DECAND: </b><span class="quantity_after_decanding_1"></span><br>                                                    <b>Exp after Decand: </b><span class="expense_after_decanding_rs_1"></span> Rs.<br>                                                </td>                                                <td>                                                    <b>Comp-Comsn: </b><span class="company_commission_1_rs_1"></span> Rs.<br>                                                    <b>W.H.T: </b><span class="wht_rs_1"></span> Rs.                                                </td>                                            </tr>                                            <tr style="border-bottom: 1px solid lightgray;">                                                <td colspan="2">                                                    <b>Stn-Number</b><br>                                                    <input type="text" name="stn_number_<?= $row_counter ?>" size="10" style="width: 100px;">                                                </td>                                                <td>                                                    <b>Total Shrt: </b><span class="total_shortage_1"></span><br>                                                    <b>Total Exp: </b><span class="total_expense_rs_1"></span> Rs.                                                </td>                                                <td>                                                    <b>Cstm-Frt: </b><span class="remaining_for_customer_rs_1"></span> Rs.                                                </td>                                            </tr>                                        </table>                                    </td>                                </tr>                            <?php                            }                            ?>                            <tr style="border-bottom: 0px; font-size: 13px;">                                <td><a style="text-decoration: none;" onclick="display_row()"><i class="fa fa-plus-circle"></i> Add Product</a><a   style="float: right; color: red; text-decoration: none;" onclick="hide_row()"><i class="fa fa-minus-circle"></i> remove</a><input size="2" value="<?= (sizeof($trip)+1) ?>" type="hidden" id="pannel_count" name="pannel_count"></td>                            </tr>                        </table>                    </div>                </div>            </div>        </div>        <div class="col-lg-12">            <div class="panel panel-default">                <div class="panel-heading">                    <h3 class="panel-title"><i class="fa fa-clock-o fa-fw"></i> Date And Time</h3>                </div>                <div class="panel-body">                    <div class="list-group">                        <div class="form-group">                            <label class="col-md-4 control-label">Receiving-Date</label>                            <div class="col-md-8">                                <input class="form-control" value="<?= $trip[0]->receiving_date; ?>" placeholder="" type="date" name='receiving_date' id='receiving_date' "">                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-4 control-label">STN-Receiving Date</label>                            <div class="col-md-8">                                <input class="form-control" value="<?= $trip[0]->stn_receiving_date; ?>" placeholder="" type="date" name='stn_receiving_date' id='stn_receiving_date' "">                            </div>                        </div>                        <div class="form-group">                            <label class="col-md-4 control-label">Decanding-Date</label>                            <div class="col-md-8">                                <input class="form-control" value="<?= $trip[0]->decanding_date; ?>" placeholder="" type="date" name='decanding_date' id='decanding_date' "">                            </div>                        </div>                    </div>                    <div class="text-right">                    </div>                </div>            </div>        </div>    </div>    <div class="col-md-4" style="font-size: 12px;">        <div class="panel panel-default drivers-helpers" style="font-size: 12px;">            <div class="panel-heading">                <h3 class="panel-title"><i class="fa fa-money fa-fw"></i> Drivers/Helpers</h3>            </div>            <div class="panel-body">                <div class="form-group">                    <label class="col-md-5 control-label">Driver</label>                    <div class="col-md-7">                        <select class="form-control drivers_select"  name="drivers_1" style=" font-size: 12px;">                            <?php                            foreach($drivers as $driver){                                $selected = ($driver->id == $trip[0]->driver_id_1)? "selected": "";                                //$disable = ($driver->id == $trip[0]->driver_id_1)? "": "disabled";                                echo "<option value=$driver->id $selected>$driver->name</option>";                            }                            ?>                        </select>                    </div>                </div>                <div class="form-group">                    <label class="col-md-5 control-label">Driver/Helper_1</label>                    <div class="col-md-7">                        <select class="form-control drivers_select"  name="drivers_2" style=" font-size: 12px;">                            <?php                            foreach($drivers as $driver){                                $selected = ($driver->id == $trip[0]->driver_id_2)? "selected": "";                                //$disable = ($driver->id == $trip[0]->driver_id_2)? "": "disabled";                                echo "<option value=$driver->id $selected>$driver->name</option>";                            }                            ?>                        </select>                    </div>                </div>                <div class="form-group">                    <label class="col-md-5 control-label">Driver/Helper_2</label>                    <div class="col-md-7">                        <select class="form-control drivers_select"  name="drivers_3" style="font-size: 12px;">                            <?php                            foreach($drivers as $driver){                                $selected = ($driver->id == $trip[0]->driver_id_3)? "selected": "";                                //$disable = ($driver->id == $trip[0]->driver_id_3)? "": "disabled";                                echo "<option  value=$driver->id $selected>$driver->name</option>";                            }                            ?>                        </select>                    </div>                </div>            </div>        </div>        <div class="panel panel-default">            <div class="panel-heading">                <h3 class="panel-title"><i class="fa fa-money fa-fw"></i> Tanker Info</h3>            </div>            <div class="panel-body">                <div class="table-responsive" id="tanker_info">                    <table class="table table-hover">                        <tbody>                        <?php                            foreach($tankers as $tanker){                                if($tanker->id == $trip[0]->tanker_id){                                    $myTanker = $tanker;                                }                            }                        ?>                        <tr>                            <td>Engin #</td>                            <td><?= $myTanker->truck_number; ?></td>                        </tr>                        <tr>                            <td>Chase #</td>                            <td><?= $myTanker->chase_number; ?></td>                        </tr>                        <tr>                            <td>Fitness Certificate</td>                            <td><?= ($myTanker->fitness_certificate == 1)? "Yes": "No"; ?></td>                        </tr>                        </tbody>                    </table>                </div>                <div class="text-center">                    <a href="#"><i class="fa fa-info-circle"></i> View Detailed Information</a>                </div>            </div>        </div>        <div class="panel panel-default">            <div class="panel-heading">                <h3 class="panel-title"><i class="fa fa-money fa-fw"></i> Invoice Info</h3>            </div>            <div class="panel-body">                <div class="table-responsive">                    <table class="table table-hover">                        <tbody>                        <tr>                            <td>Date</td>                            <td>                                <div class="form-group">                                    <div class="col-md-12">                                        <input class="form-control" type="date" value="<?= $trip[0]->invoice_date; ?>" placeholder="" name='invoice_date' id='invoice_date' "">                                    </div>                                </div>                            </td>                        </tr>                        <tr>                            <td>Number</td>                            <td>                                <div class="form-group">                                    <div class="col-md-12">                                        <input class="form-control" value="<?= $trip[0]->invoice_number; ?>" placeholder="" name='invoice_number' id='invoice_number' "">                                    </div>                                </div>                            </td>                        </tr>                        </tbody>                    </table>                </div>            </div>        </div>        <div class="panel panel-default">            <div class="panel-heading">                <h3 class="panel-title"><i class="fa fa-money fa-fw"></i> Meter Reading </h3>            </div>            <div class="panel-body">                <div class="table-responsive">                    <table class="table table-hover">                        <tbody>                        <tr>                            <th>Start</th>                            <td>                                <div class="form-group">                                    <div class="col-md-12">                                        <input class="form-control" onchange="meter_reading_changed()" onkeyup="meter_reading_changed()" type="number" step="any" value="<?= $trip[0]->start_meter ?>" placeholder="start meter reading.." name='start_meter_reading' id='start_meter_reading'>                                    </div>                                </div>                            </td>                        </tr>                        <tr>                            <th>End</th>                            <td>                                <div class="form-group">                                    <div class="col-md-12">                                        <input class="form-control" onchange="meter_reading_changed()" onkeyup="meter_reading_changed()" type="number" step="any" value="<?= $trip[0]->end_meter ?>" placeholder="end meter reading.." name='end_meter_reading' id='end_meter_reading'>                                    </div>                                </div>                            </td>                        </tr>                        <tr>                            <th>Fuel</th>                            <td>                                <div class="form-group">                                    <div class="col-md-12">                                        <input class="form-control" onchange="meter_reading_changed()" onkeyup="meter_reading_changed()" type="number" step="any"  value="<?= $trip[0]->fuel_consumed ?>" placeholder="Fuel Consumption.." name='fuel_consumed' id='fuel_consumed'>                                    </div>                                </div>                            </td>                        </tr>                        <tr>                            <td>Net Meter</td>                            <td>                                <div class="form-group">                                    <div class="col-lg-12">                                            <span id="net_meter">                                            </span>                                    </div>                                </div>                            </td>                        </tr>                        <tr>                            <th></th>                            <td>                                <div class="form-group">                                    <div class="col-md-12">                                                <span id="fuel_per_km">                                                </span> Km's / ltr                                    </div>                                </div>                            </td>                        </tr>                        </tbody>                    </table>                </div>            </div>        </div>        <?php if($trip_with_mass_payment == true): ?>            <div class="panel panel-default">                <div class="panel-heading">                    <h3 class="panel-title"><i class="fa fa-lock fa-fw"></i> Security Code </h3>                </div>                <div class="panel-body">                    <div class="table-responsive">                        <input type="password" name="security_pin" class="form-control" id="security_pin">                    </div>                </div>            </div>        <?php else: ?>            <input type="hidden" name="security_pin" id="security_pin" value="<?= $pin ?>">        <?php endif; ?>        <div class="panel panel-default">            <div class="panel-body">                <div class="table-responsive">                    <input type="submit" class="btn btn-success" value="Save This Trip" style="width: 100%" name="save_secondary_local_trip">                </div>            </div>        </div>    </div>    </div>    </form>    </div></div><script src="<?= js()."maketrip.js";?>" type="text/javascript"></script><script>    $(".customers_select").select2();    $(".contractors_select").select2();    $(".companies_select").select2();    $(".drivers_select").select2();    $(".source_city_select").select2();    $(".product_select").select2();    $(".destination_city_select").select2();</script>