<?php$file = exporting_file_name("Trips").".xls";header("Content-type: application/vnd.ms-excel");header("Content-Disposition: attachment; filename=$file");?><html><head>    <title>Trips</title></head><body><style>    .trips-table{        font-size: <?= $font_size ?>;    }    table th, td{        padding: 5px;    }    .multiple_entites{        border-bottom: 1px dashed lightgray;    }</style><div id="page-wrapper" style="min-height: 700px;">    <div class="container-fluid">        <div class="row">            <div class="col-lg-12">                <section class="col-md-6">                    <h1 class="page-header">                        Trips <small></small>                    </h1>                </section>            </div>        </div>        <div class="row">            <div class="col-lg-12">                <div class="panel-body">                    <div id="myTabContent" class="tab-content">                        <div class="tab-pane fade in active" id="trips">                            <div class="table-responsive" style="overflow-x: auto;">                                <table>                                    <tr>                                        <td colspan="9" style="font-weight: bold;"></td>                                    </tr>                                </table>                                <table class="table-bordered table-hover table-striped trips-table sortable">                                    <thead style="border-top: 4px solid lightgray;">                                    <tr>                                        <?= ((in_array('id', $columns) == true)?"<td>ID </td>":"") ?>                                        <?= ((in_array('type', $columns) == true)?"<td>Type </td>":"") ?>                                        <?= ((in_array('trip_date', $columns) == true)?"<td> Date </td>":"") ?>                                        <?= ((in_array('tanker', $columns) == true)?"<td>Tanker </td>":"") ?>                                        <?= ((in_array('capacity', $columns) == true)?"<td>Capacity </td>":"") ?>                                        <?= ((in_array('contractor', $columns) == true)?"<td> Contractor </td>":"") ?>                                        <?= ((in_array('customer', $columns) == true)?"<td>Customer</td>":"") ?>                                        <?= ((in_array('company', $columns) == true)?"<td>Company</td>":"") ?>                                        <?= ((in_array('source', $columns) == true)?"<td>Source </td>":"") ?>                                        <?= ((in_array('destination', $columns) == true)?"<td>Destination </td>":"") ?>                                        <?= ((in_array('product', $columns) == true)?"<td>Product </td>":"") ?>                                        <?= ((in_array('product_quantity', $columns) == true)?"<td>Product Quantity </td>":"") ?>                                        <?= ((in_array('stn', $columns) == true)?"<td>STN-Number</td>":"") ?>                                    </tr>                                    </thead>                                    <tbody>                                    <?php                                    $total_product_quantity = 0;                                    $total_capacity = 0;                                    ?>                                    <?php foreach($trips as $trip): ?>                                        <tr>                                            <!--first column-->                                            <?php if(in_array('id', $columns) == true): ?>                                                <?php                                                td($trip->trip_id);                                                ?>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('type', $columns) == true): ?>                                                <td>                                                    <?= $trip->trip_sub_type ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('trip_date', $columns) == true): ?>                                                <td>                                                    <?= Carbon::createFromFormat('Y-m-d',$trip->entryDate)->toFormattedDateString() ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('tanker', $columns) == true): ?>                                                <td>                                                    <?= $trip->tanker_number ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('capacity', $columns) == true): ?>                                                <td>                                                    <?php                                                    $total_capacity += $trip->capacity;                                                    echo $trip->capacity;                                                    ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('contractor', $columns) == true): ?>                                                <td>                                                    <?= $trip->contractor_name ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('customer', $columns) == true): ?>                                                <td>                                                    <?= $trip->customer_name ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('company', $columns) == true): ?>                                                <td>                                                    <?= $trip->company_name ?>                                                </td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('source', $columns) == true): ?>                                                <td style="font-size: 11px;"><?= $trip->source; ?></td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('destination', $columns) == true): ?>                                                <td style="font-size: 11px;"><?= $trip->destination; ?></td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('product', $columns) == true): ?>                                                <td style="font-size: 11px;"><?= $trip->product; ?></td>                                            <?php endif; ?>                                            <?php                                            $total_product_quantity += $trip->product_quantity;                                            ?>                                            <!--first column-->                                            <?php if(in_array('product_quantity', $columns) == true): ?>                                                <td style="font-size: 11px;"><?= $trip->product_quantity; ?></td>                                            <?php endif; ?>                                            <!--first column-->                                            <?php if(in_array('stn', $columns) == true): ?>                                                <td><?= $trip->stn_number; ?></td>                                            <?php endif; ?>                                        </tr>                                    <?php endforeach ?>                                    </tbody>                                    <tfoot>                                    <tr>                                        <?= ((in_array('id', $columns) == true)?"<th>Totals</th>":"") ?>                                        <?= ((in_array('type', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('trip_date', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('tanker', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('capacity', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('contractor', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('customer', $columns) == true)?"<th style='width: 5%;'></th>":"") ?>                                        <?= ((in_array('company', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('source', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('destination', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('product', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('product_quantity', $columns) == true)?"<th>".$this->helper_model->money($total_product_quantity)."</th>":"") ?>                                        <?= ((in_array('company_freight_unit', $columns) == true)?"<th style='width: 5%;'></th>":"") ?>                                        <?= ((in_array('stn', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('shortage_voucher_dest', $columns) == true)?"<th></th>":"") ?>                                        <?= ((in_array('shortage_voucher_decnd', $columns) == true)?"<th></th>":"") ?>                                    </tr>                                    </tfoot>                                </table>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div></div><script src="<?= js()?>sorttable.js"></script></body></html>