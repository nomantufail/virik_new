<?php/** * Created by PhpStorm. * User: Zeeshan Tufail * Date: 10/27/14 * Time: 5:43 AM */class Tanker_Details {    public $customerName;    public $truck_number;    public $engine_number;    public $chase_number;    public $fitness_certificate;    public $capacity;    public $customerId;    public $free;    public $current_trip;    public $trip_date;    private $customers;    private $incomplete_trips;    public $id;    public $ci;    function Tanker_Details($tanker, $customers = [], $incomplete_trips = []){        $this->ci =& get_instance();        //setting default values        $this->setCustomers($customers);        $this->current_trip = null;        $this->trip_date = null;        $this->set_data($tanker);    }    public function getIncompleteTrips()    {        return $this->incomplete_trips;    }    public function setIncompleteTrips($incomplete_trips = [])    {        if(sizeof($incomplete_trips) == 0){            $this->incomplete_trips = group_objects_by($this->ci->trips_model->trips_for_tankers_on_move(array('stn_number ='=>'')), 'tanker_id');        }else{            $this->incomplete_trips = $incomplete_trips;        }    }    private function getTankerIncompleteTrips($tanker_id)    {        return (isset($this->incomplete_trips[$tanker_id]))?$this->incomplete_trips[$tanker_id][0]:null;    }    public function getCustomers()    {        return $this->customers;    }    public function setCustomers($customers = [])    {        if(sizeof($customers) == 0){            $this->customers = group_objects_by($this->ci->customers_model->customers(), 'id');        }else{            $this->customers = $customers;        }    }    private function getCustomer($customerId)    {        return (isset($this->customers[$customerId]))?$this->customers[$customerId][0]:null;    }    private function  set_data($tanker){        $this->id = $tanker->id;        $this->truck_number = $tanker->truck_number;        $this->chase_number = $tanker->chase_number;        $this->engine_number = $tanker->engine_number;        $this->fitness_certificate = $tanker->fitness_certificate;        $this->capacity = $tanker->capacity;        $this->customerId = $tanker->customerId;        $this->customerName = $this->getCustomer($this->customerId)->name;        $incomplete_trips = $this->getTankerIncompleteTrips($this->id);        if(sizeof($incomplete_trips) >= 1){$this->free = false; $this->current_trip = $incomplete_trips[0]->id; $this->trip_date = $incomplete_trips[0]->entryDate;}else{$this->free = true;}    }}